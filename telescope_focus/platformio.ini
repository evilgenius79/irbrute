; PlatformIO Project Configuration File
;
; Telescope Focus Control - ESP-NOW Communication
; 
; This file contains build configurations for both:
; - M5Stack Core2 (Sender/Controller)
; - Xiao ESP32-S3 (Receiver/Motor Driver)
;
; Usage:
; 1. For M5Stack Core2: pio run -e m5stack-core2 -t upload
; 2. For Xiao ESP32-S3: pio run -e xiao-esp32s3 -t upload
; 3. For MAC finder: pio run -e mac-finder -t upload

[platformio]
default_envs = m5stack-core2

; ============================================
; M5Stack Core2 Environment (Sender)
; ============================================
[env:m5stack-core2]
platform = espressif32
board = m5stack-core2
framework = arduino
monitor_speed = 115200

; M5Stack Core2 specific settings
lib_deps = 
    m5stack/M5Core2 @ ^0.1.9

build_flags = 
    -D ARDUINO_M5STACK_CORE2

; Upload settings
upload_speed = 921600

; Build specific file
src_filter = 
    +<m5stack_core2_sender.ino>
    -<*>

; ============================================
; Xiao ESP32-S3 Environment (Receiver)
; ============================================
[env:xiao-esp32s3]
platform = espressif32
board = seeed_xiao_esp32s3
framework = arduino
monitor_speed = 115200

; Xiao ESP32-S3 specific settings
build_flags = 
    -D ARDUINO_XIAO_ESP32S3
    -D STEP_PIN=D0
    -D DIR_PIN=D1
    -D ENABLE_PIN=D2

; Upload settings
upload_speed = 921600

; Build specific file
src_filter = 
    +<xiao_esp32s3_receiver.ino>
    -<*>

; ============================================
; MAC Address Finder (Universal)
; ============================================
[env:mac-finder]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200

; Build specific file
src_filter = 
    +<get_mac_address.ino>
    -<*>

; ============================================
; Common Settings for All Environments
; ============================================
[env]
; Monitor settings
monitor_filters = 
    default
    time

; Build settings
build_type = release

; Compiler flags for optimization
build_unflags = 
    -std=gnu++11

build_flags = 
    -std=gnu++17
    -Wall
    -Wextra

; Debug configuration (uncomment for debugging)
; debug_tool = esp-prog
; debug_init_break = tbreak setup
